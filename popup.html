<!-- popup.html -->

<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Tab Sentry</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <h1>Tab Sentry</h1>

  <!-- Current open tabs -->
  <h2>Open Tabs</h2>
  <ul id="open-tabs"></ul>

  <!-- Recently closed -->
  <h2>Recently Closed</h2>
  <button id="clear">Clear history</button>
  <ul id="closed-tabs"></ul>

  <div class = "container">
        <h1>TabSentry</h1>
        <div class = "measurables">
            <div class = "counter">
                <h4>Active Tabs: </h4>
                <p id = "ActiveTabCounter"></p>
            </div>
            <div class = "resources">
                <h4>Saved Resources: </h4>
                <p id = "ResourcesSaved"></p>
            </div>
        </div>
  <hr>
  <!-- List of Active Tabs -->
  <div class = "OpenTabs">
    <h4>Open Tabs</h4>
    <button id="lock">Lock Tab</button>
    <div id="activeTabs">
        <ol id="openTabs"></ol> 
        <div class= "Empty State">
            <div class="empty-state-icon"> </div> <!-- empty state icon here -->
            No active tabs
        </div>
    </div>

  <hr>    
  <!-- Recently closed section -->
  <div class ="RecentlyClosed">
    <h4>Recently Closed</h4>
    <button id="clear">Clear history</button>
    <div id = "closedTabs">
        <div class = "empty-state">
            <div id = "history-empty-state-icon">
                No closed tabs yet

  <ol id="closed"></ol> <!-- THIS is the #closed list -->

  <script src="popup.js"></script>
</body>
</html>

<script>
  // This script will handle the popup logic, fetching open and closed tabs
  document.addEventListener('DOMContentLoaded', async () => {
    const openTabsList = document.getElementById('open-tabs');
    const closedTabsList = document.getElementById('closed-tabs');
    const clearButton = document.getElementById('clear');

    // Fetch open tabs
    const openTabs = await chrome.tabs.query({});
    openTabs.forEach(tab => {
      const li = document.createElement('li');
      li.textContent = `${tab.title} (${tab.url})`;
      openTabsList.appendChild(li);
    });

    // Fetch recently closed tabs
    const closedTabs = await chrome.sessions.getRecentlyClosed();
    closedTabs.forEach(session => {
      if (session.tab) {
        const li = document.createElement('li');
        li.textContent = `${session.tab.title} (${session.tab.url})`;
        closedTabsList.appendChild(li);
      }
    });

    // Clear history button
    clearButton.addEventListener('click', async () => {
      await chrome.sessions.clear();
      closedTabsList.innerHTML = '';
      alert('Closed tabs history cleared.');
    });
  });
</script>
<script src="popup.js"></script>
<script>
  // This script will handle the popup logic, fetching open and closed tabs
  document.addEventListener('DOMContentLoaded', async () => {
    const openTabsList = document.getElementById('open-tabs');
    const closedTabsList = document.getElementById('closed-tabs');
    const clearButton = document.getElementById('clear');})